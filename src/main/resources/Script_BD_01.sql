
-- ********************************************** --
-- ****************** TABLAs: ******************* --  
-- ********************************************** --
CREATE TABLE TB_EMPLEADOS(
    EMP_ID      INT NOT NULL CONSTRAINT PK_EMP PRIMARY KEY,
    EMP_NOMBRE  VARCHAR2( 30 ),
    EMP_EDAD    INT,
    EMP_ROL     VARCHAR2( 20 ) 
);

CREATE TABLE TB_DEPARTAMENTOS(
    DEP_ID      INT NOT NULL CONSTRAINT PK_DEP PRIMARY KEY,
    DEP_NOMBRE  VARCHAR2( 30 )  
);

CREATE TABLE TB_ORGANIZACIONES(
    ORG_ID         INT NOT NULL CONSTRAINT PK_ORG PRIMARY KEY,
    ORG_NOMBRE     VARCHAR2( 30 ), 
    ORG_DIRECCION  VARCHAR2( 50 ) 
);

CREATE TABLE TB_DEP_EMP( 
    DEP_ID  INT NOT NULL,
    EMP_ID  INT NOT NULL 
); 

CREATE TABLE TB_ORG_DEP( 
    ORG_ID  INT NOT NULL,
    DEP_ID  INT NOT NULL 
);  

SELECT * FROM TB_EMPLEADOS;
SELECT * FROM TB_DEPARTAMENTOS;
SELECT * FROM TB_ORGANIZACIONES;
SELECT * FROM TB_DEP_EMP;
SELECT * FROM TB_ORG_DEP; 

SELECT * FROM TB_EMPLEADOS       FOR UPDATE;
SELECT * FROM TB_DEPARTAMENTOS   FOR UPDATE;
SELECT * FROM TB_ORGANIZACIONES  FOR UPDATE;
SELECT * FROM TB_DEP_EMP         FOR UPDATE;
SELECT * FROM TB_ORG_DEP         FOR UPDATE; 


-- ********************************************** --
-- ****************** INSERTs: ****************** --
-- ********************************************** --
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 1,  'JOHN SMITH',      34, 'ANALYST'   );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 2,  'DARREN HAMILTON', 32, 'MANAGER'   );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 3,  'TOM SCOTT',       34, 'DEVELOPER' );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 4,  'ANNA LONDON',     26, 'ANALYST'   );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 5,  'PATRICK DEMPSEY', 27, 'DEVELOPER' );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 6,  'KEVIN PRICE',     28, 'DEVELOPER' );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 7,  'IAN SCOTT',       37, 'DEVELOPER' );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 8,  'ANDREW CAMPTON',  29, 'MANAGER'   );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 9,  'STEVE FRANKLIN',  30, 'DEVELOPER' );
INSERT INTO TB_EMPLEADOS( EMP_ID, EMP_NOMBRE, EMP_EDAD, EMP_ROL ) VALUES( 10, 'ELISABETH SMITH', 31, 'DEVELOPER' );
 
INSERT INTO TB_DEPARTAMENTOS( DEP_ID, DEP_NOMBRE ) VALUES( 1, 'DESARROLLO'  );
INSERT INTO TB_DEPARTAMENTOS( DEP_ID, DEP_NOMBRE ) VALUES( 2, 'OPERACIONES' );
INSERT INTO TB_DEPARTAMENTOS( DEP_ID, DEP_NOMBRE ) VALUES( 3, 'DESARROLLO'  );
INSERT INTO TB_DEPARTAMENTOS( DEP_ID, DEP_NOMBRE ) VALUES( 4, 'OPERACIONES' );
  
INSERT INTO TB_ORGANIZACIONES( ORG_ID, ORG_NOMBRE, ORG_DIRECCION ) VALUES( 1, 'IBM',    'Redmond, Washington, USA'      );
INSERT INTO TB_ORGANIZACIONES( ORG_ID, ORG_NOMBRE, ORG_DIRECCION ) VALUES( 2, 'ORACLE', 'Redwood City, California, USA' );

INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 1, 1 );
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 1, 2 );    
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 1, 3 );    
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 2, 4 );    
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 2, 5 );    
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 2, 6 ); 
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 3, 7 );    
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 3, 8 ); 
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 4, 9 ); 
INSERT INTO TB_DEP_EMP( DEP_ID, EMP_ID ) VALUES( 4, 10 ); 

INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 1, 1 );
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 1, 2 );   
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 1, 3 );
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 1, 4 ); 
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 2, 1 );
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 2, 2 ); 
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 2, 3 );
INSERT INTO TB_ORG_DEP( ORG_ID, DEP_ID ) VALUES( 2, 4 );


-- ********************************************** --
-- **************** SEQUENCEs: ****************** --
-- ********************************************** -- 
CREATE SEQUENCE SQ_EMPLEADOS
MAXVALUE 999999999999999999999999999
START WITH 11
INCREMENT BY 1
NOCACHE;
 
CREATE SEQUENCE SQ_DEPARTAMENTOS
MAXVALUE 999999999999999999999999999
START WITH 5
INCREMENT BY 1
NOCACHE;

CREATE SEQUENCE SQ_ORGANIZACION
MAXVALUE 999999999999999999999999999
START WITH 3
INCREMENT BY 1
NOCACHE;


-- ********************************************** --
-- ****************** QUERYs: ******************* --
-- ********************************************** --

-- BUSCAR 'EMPLEADOS' POR 'DEPARTAMENTO': 
SELECT d.DEP_ID, d.DEP_NOMBRE, e.EMP_ID, e.EMP_NOMBRE, e.EMP_EDAD, e.EMP_ROL
FROM   TB_EMPLEADOS e, TB_DEPARTAMENTOS d, TB_DEP_EMP de
WHERE  de.DEP_ID = d.DEP_ID
AND    de.EMP_ID = e.EMP_ID 
AND    d.DEP_ID  = 3; 

-- BUSCAR 'DEPARTAMENTOS' POR 'ORGANIZACION': 
SELECT o.org_id, o.org_nombre, o.org_direccion, d.dep_id, d.dep_nombre
FROM   TB_ORGANIZACIONES o, TB_DEPARTAMENTOS d, TB_ORG_DEP od
WHERE  od.org_id = o.org_id 
AND    od.DEP_ID = d.DEP_ID 
AND    o.org_id  = 2; 

-- BUSCAR 'EMPLEADOS' & 'DEPARTAMENTOS' POR 'ORGANIZACION': 
SELECT o.org_id, o.org_nombre, o.org_direccion, d.DEP_ID, d.DEP_NOMBRE, e.EMP_ID, e.EMP_NOMBRE, e.EMP_EDAD, e.EMP_ROL
FROM   TB_ORGANIZACIONES o, TB_DEPARTAMENTOS d, TB_EMPLEADOS e, TB_ORG_DEP od, TB_DEP_EMP de
WHERE  od.org_id = o.org_id 
AND    od.DEP_ID = d.DEP_ID 
AND    de.DEP_ID = d.DEP_ID
AND    de.EMP_ID = e.EMP_ID 
AND    o.org_id  = 1; 
 